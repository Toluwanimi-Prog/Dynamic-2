dataset_clean <- dataset %>%
distinct() %>%
filter(!is.na(description))  # Make sure description column has valid values
# Task 2: Cleaning the data
**We'll focus on removing extreme outliers instead of just using boxplots**
# Load libraries
library(readxl)
library(dplyr)
library(ggplot2)
library(tidyr)  # New: for better reshaping of data
library(janitor) # New: for quick data cleaning
# Task 1: Load the dataset
file_path <- "C:/Users/toluf/OneDrive/Desktop/Visualization/Group Project/Group_Projectdata.xlsx"
dataset <- read_excel(file_path, sheet = "3-1") %>%
clean_names()  # Automatically cleans and standardizes column names
# Explore the structure and check for basic issues
glimpse(dataset)  # New: Offers a quick summary overview of data
# Identifying missing values in a more detailed way
missing_vals <- dataset %>%
summarise(across(everything(), ~ sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "column", values_to = "missing_count")
print(missing_vals)  # Check where missing data exists
# Visualize missing data using ggplot
ggplot(missing_vals, aes(x = column, y = missing_count)) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(title = "Missing Data Overview", x = "Columns", y = "Count of Missing Values") +
coord_flip()
# Remove duplicated rows and filter out non-numeric columns
dataset_clean <- dataset %>%
distinct() %>%
filter(!is.na(description))  # Make sure description column has valid values
dataset_clean <- dataset %>
# Visualize missing data using ggplot
ggplot(missing_vals, aes(x = column, y = missing_count)) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(title = "Missing Data Overview", x = "Columns", y = "Count of Missing Values") +
coord_flip()
# Remove duplicated rows and filter out non-numeric columns
dataset_clean <- dataset %>%
distinct() %>%
filter(!is.na(description))  # Make sure description column has valid values
colnames(dataset)
file_path <- "C:/Users/toluf/OneDrive/Desktop/Visualization/Group Project/Group_Projectdata.xlsx"
dataset <- read_excel(file_path, sheet = "3-1") %>%
clean_names()  # Automatically cleans and standardizes column names
library(readxl)
library(dplyr)
library(ggplot2)
library(tidyr)  # New: for better reshaping of data
library(janitor) # New: for quick data cleaning
file_path <- "C:/Users/toluf/OneDrive/Desktop/Visualization/Group Project/Group_Projectdata.xlsx"
dataset <- read_excel(file_path, sheet = "3-1") %>%
clean_names()  # Automatically cleans and standardizes column names
glimpse(dataset)  # New: Offers a quick summary overview of data
missing_vals <- dataset %>%
summarise(across(everything(), ~ sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "column", values_to = "missing_count")
print(missing_vals)  # Check where missing data exists
ggplot(missing_vals, aes(x = column, y = missing_count)) +
geom_bar(stat = "identity") +
theme_minimal() +
labs(title = "Missing Data Overview", x = "Columns", y = "Count of Missing Values") +
coord_flip()
colnames(dataset)
dataset_clean <- dataset %>%
distinct() %>%
filter(!is.na(description))  # Make sure description column has valid values
View(dataset)
colnames(dataset)
dataset_clean <- dataset %>%
distinct() %>%
filter(!is.na(sector_description))  # Replace 'description' with the actual column name
dataset_clean <- dataset_clean %>%
mutate(across(where(is.numeric), ~ ifelse(is.na(.), zoo::na.approx(.), .)))  # Linear interpolation
colnames(dataset)
str(dataset)
colnames(dataset)
str(dataset)
# Identify missing values
sum(is.na(dataset))
# Remove rows with missing values
dataset <- na.omit(dataset)
file_path <- "C:/Users/toluf/OneDrive/Desktop/Visualization/Group Project/Group_Projectdata.xlsx"
dataset <- read_excel(file_path, sheet = "3-1") %>%
clean_names()  # Automatically cleans and standardizes column names
glimpse(dataset)  # New: Offers a quick summary overview of data
library(readxl)
data_xlsx <- read_excel("C:/Users/toluf/OneDrive/Desktop/Dynamic 2/cp_Finalmain/finalpro.xlsx", sheet = "Sheet2")
library(esquisse)
esquisse::esquisser(data_xlsx)
library(readxl)
data_xlsx <- read_excel("C:/Users/toluf/OneDrive/Desktop/Dynamic 2/cp_Finalmain/finalpro.xlsx", sheet = "Sheet2")
library(esquisse)
library(ggplot2)
ggplot(data_xlsx) +
aes(x = `TOTAL U.S. GDP`, y = `Air transportation...4`) +
geom_point(size = 2.25, colour = "#112446") +
labs(
y = "Air Transportation GDP",
title = "Air Transportation GDP on Total U.S. GDP"
) +
theme_bw()
# Gantt-style timeline plot
ggplot(events, aes(x = start_year, xend = end_year, y = event, yend = event, color = type)) +
geom_segment(size = 5) +  # Create horizontal bars for each event
scale_x_continuous(breaks = seq(2005, 2022, by = 1)) +  # Set x-axis breaks for each year
labs(
title = "Gantt-Style Timeline of Major External Factors Affecting the U.S. Transportation Sector",
x = "Year",
y = "Event"
) +
theme_minimal() +
theme(
axis.text.y = element_text(size = 8),  # Adjust y-axis text size for readability
legend.position = "bottom"
) +
guides(color = guide_legend(title = "Event Type"))  # Legend for event types
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(readxl)  # For reading Excel files
# Load the dataset
file_path <- "C:/Users/toluf/OneDrive/Desktop/Dynamic 2/Olufawo_FinalProjectWeek1/Dataset_USGDP.xlsx"
data <- read_excel(file_path)
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(readxl)  # For reading Excel files
# Load the dataset
file_path <- "C:/Users/toluf/OneDrive/Desktop/Dynamic 2/Olufawo_FinalProjectWeek1/Dataset_USGDP.xlsx"
data <- read_excel(file_path)
# View the first few rows of the dataset
head(data)
# Check column names
colnames(data)
# Create a data frame with specific events for the timeline
events <- data.frame(
year = c(2005, 2008, 2009, 2010, 2011, 2012, 2015, 2020, 2021, 2022),
label = c(
"Fuel Prices Spike",
"Energy Policy Act",
"Global Financial Crisis",
"FMCSA Safety Regulations",
"Natural Gas Boom",
"MAP-21 Act",
"Low Oil Prices",
"COVID-19 Pandemic & CARES Act",
"Supply Chain Disruptions & Infrastructure Act",
"Fuel Price Surge"
),
type = c("Fuel", "Policy", "Global", "Policy", "Fuel", "Policy", "Fuel", "Global", "Global/Policy", "Fuel")
)
# Plot the timeline with line width aesthetic
ggplot(events, aes(x = year, y = 1, color = type)) +
geom_point(size = 5) +  # Points for each event
geom_segment(aes(x = year, xend = year, y = 1, yend = 0.9), color = "gray", linewidth = 0.5) +  # Adjusted to use linewidth
geom_text(aes(label = label), angle = 45, hjust = 0, nudge_y = 0.2, size = 3.5) +  # Event labels
scale_x_continuous(breaks = seq(2005, 2022, by = 1)) +  # Set x-axis breaks for each year
labs(
title = "Timeline of Major External Factors Affecting the U.S. Transportation Sector",
x = "Year",
y = ""
) +
theme_minimal() +
theme(
axis.text.y = element_blank(),  # Remove y-axis text
axis.ticks.y = element_blank(),  # Remove y-axis ticks
legend.position = "bottom"
) +
guides(color = guide_legend(title = "Event Type"))  # Legend for event types
# Load necessary libraries
library(ggplot2)
library(dplyr)
# Define the data with start and end years for Gantt-style visualization
events <- data.frame(
event = c(
"Fuel Prices Spike", "Energy Policy Act", "Global Financial Crisis",
"FMCSA Safety Regulations", "Natural Gas Boom", "MAP-21 Act",
"Low Oil Prices", "COVID-19 Pandemic & CARES Act",
"Supply Chain Disruptions & Infrastructure Act", "Fuel Price Surge"
),
type = c("Fuel", "Policy", "Global", "Policy", "Fuel", "Policy", "Fuel", "Global", "Global/Policy", "Fuel"),
start_year = c(2005, 2008, 2009, 2010, 2011, 2012, 2015, 2020, 2021, 2022),
end_year = c(2008, 2008, 2009, 2010, 2014, 2012, 2018, 2020, 2022, 2022)
)
# Gantt-style timeline plot
ggplot(events, aes(x = start_year, xend = end_year, y = event, yend = event, color = type)) +
geom_segment(size = 5) +  # Create horizontal bars for each event
scale_x_continuous(breaks = seq(2005, 2022, by = 1)) +  # Set x-axis breaks for each year
labs(
title = "Gantt-Style Timeline of Major External Factors Affecting the U.S. Transportation Sector",
x = "Year",
y = "Event"
) +
theme_minimal() +
theme(
axis.text.y = element_text(size = 8),  # Adjust y-axis text size for readability
legend.position = "bottom"
) +
guides(color = guide_legend(title = "Event Type"))  # Legend for event types
# Gantt-style timeline plot
ggplot(events, aes(x = start_year, xend = end_year, y = event, yend = event, color = type)) +
geom_segment(linewidth = 5) +  # Use linewidth instead of size for line thickness
scale_x_continuous(breaks = seq(2005, 2022, by = 1)) +  # Set x-axis breaks for each year
labs(
title = "Gantt-Style Timeline of Major External Factors Affecting the U.S. Transportation Sector",
x = "Year",
y = "Event"
) +
theme_minimal() +
theme(
axis.text.y = element_text(size = 8),  # Adjust y-axis text size for readability
legend.position = "bottom"
) +
guides(color = guide_legend(title = "Event Type"))  # Legend for event types
es(color = guide_legend(title = "Event Type"))  # Legend for event types
# Gantt-style timeline plot
ggplot(events, aes(x = start_year, xend = end_year, y = event, yend = event, color = type)) +
geom_segment(linewidth = 5) +  # Use linewidth instead of size for line thickness
scale_x_continuous(breaks = seq(2005, 2022, by = 1)) +  # Set x-axis breaks for each year
labs(
title = "Gantt-Style Timeline of Major External Factors Affecting the U.S. Transportation Sector",
x = "Year",
y = "Event"
) +
theme_minimal() +
theme(
axis.text.y = element_text(size = 8),  # Adjust y-axis text size for readability
legend.position = "bottom"
) +
guides(color = guide_legend(title = "Event Type"))  # Legend for event types
file_path <- "C:/Users/tolu/Onedrive/Desktop/Dynamic 2/Db_finalMain/table_03_01_072623.xlsx"
dataset <- read_excel(file_path, sheet = 4)
library(readxl)
library(tidyr)
library(ggplot2)
file_path <- "C:/Users/tolu/Onedrive/Desktop/Dynamic 2/Db_finalMain/table_03_01_072623.xlsx"
dataset <- read_excel(file_path, sheet = 4)
file_path <- "C:/Users/tolu/OneDrive/Desktop/Dynamic 2/Db_finalMain/table_03_01_072623.xlsx"
dataset <- read_excel(file_path, sheet = 4)
file_path <- "C:/Users/toluf/OneDrive/Desktop/Dynamic 2/Db_finalMain/table_03_01_072623.xlsx"
data <- read_excel(file_path, sheet = 4)
dataset
summary(dataset)
duplicated_rows <- dataset[duplicated(dataset), ]
# changing col names
clean_names <- c(
"Year",
"Total_GDP",
"Transport_GDP_Total",
"Air",
"Rail",
"Water",
"Truck",
"Transit",
"Pipeline",
"Other",
"Warehousing",
"Percent_GDP",
"Transport_Services",
"Air_Pct",
"Rail_Pct",
"Water_Pct",
"Truck_Pct",
"Transit_Pct",
"Pipeline_Pct",
"Other_Pct",
"Warehousing_Pct",
"Pct_Transport_GDP",
"Air_Share",
"Rail_Share",
"Water_Share",
"Truck_Share",
"Transit_Share",
"Pipeline_Share",
"Other_Share",
"Warehousing_Share"
)
# Assign new column names
colnames(dataset) <- clean_names
# Redoing col 1, rows 26:30
dataset[26, 1] <- "2017"
dataset[27, 1] <- "2018"
dataset[28, 1] <- "2019"
dataset[29, 1] <- "2020"
dataset[30, 1] <- "2021"
# Select relevant columns and convert to long format
transport_long <- dataset %>%
select(Year, Air, Rail, Water, Truck, Transit, Pipeline, Other, Warehousing) %>%
pivot_longer(cols = -Year,
names_to = "Sector",
values_to = "GDP")
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
file_path <- "C:/Users/toluf/OneDrive/Desktop/Dynamic 2/Db_finalMain/table_03_01_072623.xlsx"
data <- read_excel(file_path, sheet = 4)
summary(dataset)
duplicated_rows <- dataset[duplicated(dataset), ]
# changing col names
clean_names <- c(
"Year",
"Total_GDP",
"Transport_GDP_Total",
"Air",
"Rail",
"Water",
"Truck",
"Transit",
"Pipeline",
"Other",
"Warehousing",
"Percent_GDP",
"Transport_Services",
"Air_Pct",
"Rail_Pct",
"Water_Pct",
"Truck_Pct",
"Transit_Pct",
"Pipeline_Pct",
"Other_Pct",
"Warehousing_Pct",
"Pct_Transport_GDP",
"Air_Share",
"Rail_Share",
"Water_Share",
"Truck_Share",
"Transit_Share",
"Pipeline_Share",
"Other_Share",
"Warehousing_Share"
)
# Assign new column names
colnames(dataset) <- clean_names
# Redoing col 1, rows 26:30
dataset[26, 1] <- "2017"
dataset[27, 1] <- "2018"
dataset[28, 1] <- "2019"
dataset[29, 1] <- "2020"
dataset[30, 1] <- "2021"
# Select relevant columns and convert to long format
transport_long <- dataset %>%
select(Year, Air, Rail, Water, Truck, Transit, Pipeline, Other, Warehousing) %>%
pivot_longer(cols = -Year,
names_to = "Sector",
values_to = "GDP")
# Create stacked bar chart for all years
# Convert Year to factor for first plot to ensure discrete x-axis
p1 <- ggplot(transport_long, aes(x = as.factor(Year), y = GDP, fill = Sector)) +
geom_bar(stat = "identity") +
labs(title = "For-hire Transportation GDP by Sector (1980-2022)",
x = "Year",
y = "GDP (Billions of Dollars)",
fill = "Transportation Sector") +
theme_minimal() +
scale_fill_brewer(palette = "Set2") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5),
legend.position = "bottom") +
# Show fewer year labels to prevent overcrowding
scale_x_discrete(breaks = function(x) x[seq(1, length(x), by = 2)])
# Create filtered version showing only decade intervals
transport_long_filtered <- transport_long %>%
filter(Year %in% seq(1980, 2022, by = 10))
p2 <- ggplot(transport_long_filtered, aes(x = as.factor(Year), y = GDP, fill = Sector)) +
geom_bar(stat = "identity") +
labs(title = "For-hire Transportation GDP by Sector (Decade Intervals)",
x = "Year",
y = "GDP (Billions of Dollars)",
fill = "Transportation Sector") +
theme_minimal() +
scale_fill_brewer(palette = "Set2") +
theme(axis.text.x = element_text(angle = 37),
plot.title = element_text(hjust = 0.3),
legend.position = "bottom")
# Display both plots
p1
p2
p3
# Select relevant columns and convert to long format
transport_long <- dataset %>%
select(Year, Air, Rail, Water, Truck, Transit, Pipeline, Other, Warehousing) %>%
pivot_longer(cols = -Year,
names_to = "Sector",
values_to = "GDP")
# Create stacked bar chart for all years
# Convert Year to factor for first plot to ensure discrete x-axis
p1 <- ggplot(transport_long, aes(x = as.factor(Year), y = GDP, fill = Sector)) +
geom_bar(stat = "identity") +
labs(title = "For-hire Transportation GDP by Sector (1980-2022)",
x = "Year",
y = "GDP (Billions of Dollars)",
fill = "Transportation Sector") +
theme_minimal() +
scale_fill_brewer(palette = "Set2") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5),
legend.position = "bottom") +
# Show fewer year labels to prevent overcrowding
scale_x_discrete(breaks = function(x) x[seq(1, length(x), by = 2)])
# Create filtered version showing only decade intervals
transport_long_filtered <- transport_long %>%
filter(Year %in% seq(1980, 2022, by = 10))
p2 <- ggplot(transport_long_filtered, aes(x = as.factor(Year), y = GDP, fill = Sector)) +
geom_bar(stat = "identity") +
labs(title = "For-hire Transportation GDP by Sector (Decade Intervals)",
x = "Year",
y = "GDP (Billions of Dollars)",
fill = "Transportation Sector") +
theme_minimal() +
scale_fill_brewer(palette = "Set2") +
theme(axis.text.x = element_text(angle = 37),
plot.title = element_text(hjust = 0.3),
legend.position = "bottom")
# Display both plots
p1
p2
library(readxl)
library(tidyr)
library(dplyr)
library(ggplot2)
library(readxl)
library(tidyr)
library(dplyr)
library(ggplot2)
file_path <- "C:/Users/toluf/OneDrive/Desktop/Dynamic 2/Db_finalMain/table_03_01_072623.xlsx"
dataset <- read_excel(file_path, sheet = 4)
dataset
summary(dataset)
duplicated_rows <- dataset[duplicated(dataset), ]
# changing col names
clean_names <- c(
"Year",
"Total_GDP",
"Transport_GDP_Total",
"Air",
"Rail",
"Water",
"Truck",
"Transit",
"Pipeline",
"Other",
"Warehousing",
"Percent_GDP",
"Transport_Services",
"Air_Pct",
"Rail_Pct",
"Water_Pct",
"Truck_Pct",
"Transit_Pct",
"Pipeline_Pct",
"Other_Pct",
"Warehousing_Pct",
"Pct_Transport_GDP",
"Air_Share",
"Rail_Share",
"Water_Share",
"Truck_Share",
"Transit_Share",
"Pipeline_Share",
"Other_Share",
"Warehousing_Share"
)
# Assign new column names
colnames(dataset) <- clean_names
# Redoing col 1, rows 26:30
dataset[26, 1] <- "2017"
dataset[27, 1] <- "2018"
dataset[28, 1] <- "2019"
dataset[29, 1] <- "2020"
dataset[30, 1] <- "2021"
# Select relevant columns and convert to long format
transport_long <- dataset %>%
select(Year, Air, Rail, Water, Truck, Transit, Pipeline, Other, Warehousing) %>%
pivot_longer(cols = -Year,
names_to = "Sector",
values_to = "GDP")
# Create stacked bar chart for all years
# Convert Year to factor for first plot to ensure discrete x-axis
p1 <- ggplot(transport_long, aes(x = as.factor(Year), y = GDP, fill = Sector)) +
geom_bar(stat = "identity") +
labs(title = "For-hire Transportation GDP by Sector (1980-2022)",
x = "Year",
y = "GDP (Billions of Dollars)",
fill = "Transportation Sector") +
theme_minimal() +
scale_fill_brewer(palette = "Set2") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(hjust = 0.5),
legend.position = "bottom") +
# Show fewer year labels to prevent overcrowding
scale_x_discrete(breaks = function(x) x[seq(1, length(x), by = 2)])
# Create filtered version showing only decade intervals
transport_long_filtered <- transport_long %>%
filter(Year %in% seq(1980, 2022, by = 10))
p2 <- ggplot(transport_long_filtered, aes(x = as.factor(Year), y = GDP, fill = Sector)) +
geom_bar(stat = "identity") +
labs(title = "For-hire Transportation GDP by Sector (Decade Intervals)",
x = "Year",
y = "GDP (Billions of Dollars)",
fill = "Transportation Sector") +
theme_minimal() +
scale_fill_brewer(palette = "Set2") +
theme(axis.text.x = element_text(angle = 37),
plot.title = element_text(hjust = 0.3),
legend.position = "bottom")
# Display both plots
p1
p2
